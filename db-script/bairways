DROP schema if exists AIRLINE;
CREATE schema AIRLINE;
use AIRLINE;
DROP TABLE IF EXISTS Booking;
DROP TABLE IF EXISTS User;
DROP TABLE IF EXISTS User_Category;
DROP TABLE IF EXISTS Seat;
DROP TABLE IF EXISTS Schedule;
DROP TABLE IF EXISTS Category;
DROP TABLE IF EXISTS Route;
DROP TABLE IF EXISTS Airport;
DROP TABLE IF EXISTS Address;
DROP TABLE IF EXISTS Passenger;
DROP TABLE IF EXISTS Plane;
DROP TABLE IF EXISTS Aircraft;
CREATE TABLE Address (
    Location_ID INT auto_increment PRIMARY KEY,
    Parent_Location_ID INT,
    Address VARCHAR(255)
);

CREATE TABLE Aircraft (
    Aircraft_ID INT PRIMARY KEY,
    Company VARCHAR(255),
    Aircraft_type VARCHAR(255),
    Total_seats INT,
    Economy_seat_start_no INT,
    Business_seat_start_no INT,
    Platinum_seat_start_no INT
);

CREATE TABLE Airport (
    Airport_Code VARCHAR(5) PRIMARY KEY,
    Airport_name VARCHAR(255),
    Location_ID INT,
    FOREIGN KEY (Location_ID) REFERENCES Address(Location_ID)
);

CREATE TABLE Plane (
    Plane_ID INT auto_increment PRIMARY KEY,
    Aircraft_ID INT,
    Plane_name VARCHAR(20),
    Total_seats INT,
    Economy_seat_start_no INT,
    Business_seat_start_no INT,
    Platinum_seat_start_no INT,
    FOREIGN KEY (Aircraft_ID) REFERENCES Aircraft(Aircraft_ID)
);

CREATE TABLE Route (
    Route_ID INT auto_increment PRIMARY KEY,
    Departure_Airport VARCHAR(5),
    Arrival_Airport VARCHAR(5),
    FOREIGN KEY (Departure_Airport) REFERENCES Airport(Airport_Code),
    FOREIGN KEY (Arrival_Airport) REFERENCES Airport(Airport_Code)
);

CREATE TABLE Passenger (
    Passenger_ID CHAR(36) PRIMARY KEY,
    Passenger_Name VARCHAR(200),
    Passport_Number CHAR(10),
    DOB DATE,
    Gender ENUM('Male', 'Female')
);

CREATE TABLE User (
    User_ID CHAR(36) PRIMARY KEY,
    User_Name VARCHAR(200),
    First_name VARCHAR(200),
    Last_name VARCHAR(200),
    Email VARCHAR(200),
    DOB DATE,
    Age INT,
    Gender ENUM('Male', 'Female'),
    Password VARCHAR(255),
    Role ENUM('Admin', 'registered user')
);

CREATE TABLE Category (
    Category_ID INT PRIMARY KEY,
    Category_Type VARCHAR(255),
    Discount DECIMAL(2,2)
);

CREATE TABLE User_Category (
    User_ID CHAR(36),
    Bookings_count INT,
    Category_ID INT,
    FOREIGN KEY (User_ID) REFERENCES User(User_ID),
    FOREIGN KEY (Category_ID) REFERENCES Category(Category_ID)
);



CREATE TABLE Schedule (
    Schedule_ID CHAR(36) PRIMARY KEY,
    Route_ID INT,
    Plane_ID INT,
    Departure_Time DATETIME,
    Arrival_Time DATETIME,
    Economy_Fare DECIMAL(10,2),
    Business_Fare DECIMAL(10,2),
    Platinum_Fare DECIMAL(10,2),
    FOREIGN KEY (Route_ID) REFERENCES Route(Route_ID),
    FOREIGN KEY (Plane_ID) REFERENCES Plane(Plane_ID)
);

CREATE TABLE Seat (
    Seat_ID CHAR(36) PRIMARY KEY,
    Schedule_ID CHAR(36),
    Seat_number INT,
    Seat_class ENUM('economy', 'business', 'platinum'),
    Seat_status ENUM('available', 'selected', 'booked'),
    FOREIGN KEY (Schedule_ID) REFERENCES Schedule(Schedule_ID)
);

CREATE TABLE Booking (
    Booking_ID CHAR(36) PRIMARY KEY,
    Passenger_ID CHAR(36),
    User_ID CHAR(36),
    Seat_ID VARCHAR(100),
    Final_Price DECIMAL(10,2),
    Booking_Status ENUM('pending', 'confirmed', 'cancelled'),
    FOREIGN KEY (Passenger_ID) REFERENCES Passenger(Passenger_ID),
    FOREIGN KEY (User_ID) REFERENCES User(User_ID),
    FOREIGN KEY (Seat_ID) REFERENCES Seat(Seat_ID)
);


